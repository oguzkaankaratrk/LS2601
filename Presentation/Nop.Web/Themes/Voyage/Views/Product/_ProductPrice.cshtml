@model ProductPriceModel

@using Nop.Core
@using Nop.Core.Domain.Tax
@inject IWorkContext workContext

@{
    decimal? discountPercent = null;

    if (Model.OldPriceValue.HasValue
        && Model.OldPriceValue.Value > 0
        && Model.PriceValue.HasValue
        && Model.PriceValue.Value < Model.OldPriceValue.Value)
    {
        var oldPriceVal = Model.OldPriceValue.Value;
        var newPriceVal = Model.PriceValue.Value;

        discountPercent = Math.Round(
            (oldPriceVal - newPriceVal) / oldPriceVal * 100, 0
        );
    }
}

@if (!Model.CustomerEntersPrice)
{
<div class="prices">
    @if (Model.CallForPrice)
    {
        <div class="product-price call-for-price">
            <span>@T("Products.CallForPrice")</span>
        </div>
    }
    else
    {
        if (Model.IsRental)
        {
            <div class="rental-price">
                <label>@T("Products.Price.RentalPrice"):</label>
                <span>@Model.RentalPrice</span>
            </div>
        }
        //product-price discounted-price
        if (!string.IsNullOrWhiteSpace(Model.PriceWithDiscount))
        {
            <div class="product-price discounted-price">
                <label>@T("Products.Price.WithDiscount"):</label>
                <strong class="price-value-@(Model.ProductId)">
                    @Html.Raw(Model.PriceWithDiscount)
                </strong>
            </div>
        }
        <div class="@if (string.IsNullOrWhiteSpace(Model.PriceWithDiscount))
                    {
                        <text>product-price</text>
                    }
                    else
                    {
                        <text>non-discounted-price</text>
                    }">
            @if (!string.IsNullOrWhiteSpace(Model.OldPrice) || !string.IsNullOrWhiteSpace(Model.PriceWithDiscount))
            {
                @*<label for="price-value-@(Model.ProductId)">@T("Products.Price"):</label>*@
            }
            <strong @if (string.IsNullOrWhiteSpace(Model.PriceWithDiscount)) { <text> id="price-value-@(Model.ProductId)" class="price-value-@(Model.ProductId)" </text> }>
                    @Html.Raw(Model.Price)
                </strong>
        </div>


    //old-product-price
    if (!string.IsNullOrWhiteSpace(Model.OldPrice))
    {
        <div class="old-product-price">
            <label>@T("Products.Price.OldPrice"):</label>
            <strong>@Model.OldPrice</strong>
            <span class="adidas-discount-percent">-@discountPercent%</span>
        </div>
    }
    if (!string.IsNullOrEmpty(Model.BasePricePAngV))
    {
        <div class="base-price-pangv" id="base-price-pangv-@Model.ProductId">
            @Model.BasePricePAngV
        </div>
    }
    if (Model.DisplayTaxShippingInfo)
    {
        var inclTax = await workContext.GetTaxDisplayTypeAsync() == TaxDisplayType.IncludingTax;
        //tax info is already included in the price (incl/excl tax). that's why we display only shipping info here
        //of course, you can modify appropriate locales to include VAT info there
        <div class="tax-shipping-info">
            @T(inclTax ? "Products.Price.TaxShipping.InclTax" : "Products.Price.TaxShipping.ExclTax", Url.RouteTopicUrl("shippinginfo"))
        </div>
    }
        }
</div>
}
